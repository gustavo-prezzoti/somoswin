# =====================================
# Win AI Backend - Docker Profile
# =====================================
# Ativado com: SPRING_PROFILES_ACTIVE=docker
# =====================================

spring.application.name=winai

# ========================================
# Database Configuration
# ========================================
# Uses environment variables from Docker Compose
spring.datasource.url=${DATABASE_URL:jdbc:postgresql://localhost:5432/postgres?currentSchema=winai}
spring.datasource.username=${DATABASE_USERNAME:postgres}
spring.datasource.password=${DATABASE_PASSWORD:password}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA/Hibernate Configuration
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=${SPRING_JPA_HIBERNATE_DDL_AUTO:update}
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.default_schema=${SPRING_JPA_PROPERTIES_HIBERNATE_DEFAULT_SCHEMA:public}

# Flyway Migration Configuration
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.schemas=${SPRING_FLYWAY_SCHEMAS:public}
spring.flyway.default-schema=${SPRING_FLYWAY_DEFAULT_SCHEMA:public}
spring.flyway.baseline-on-migrate=true

# Connection Pool Configuration (HikariCP) - Otimizado para container
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=2
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=600000

# ========================================
# JWT Configuration
# ========================================
jwt.secret=${JWT_SECRET:V2luQUlCYWNrZW5kU2VjcmV0S2V5Rm9ySldUVG9rZW5zMjAyNSFAIyQlXiYqKCk=}
jwt.expiration=${JWT_EXPIRATION:3600000}
jwt.refresh-expiration=${JWT_REFRESH_EXPIRATION:604800000}

# ========================================
# Supabase API Keys
# ========================================
supabase.url=${SUPABASE_URL:https://example.supabase.co}
supabase.anon-key=${SUPABASE_ANON_KEY:}
supabase.service-role-key=${SUPABASE_SERVICE_ROLE_KEY:}

# ========================================
# Google APIs (Drive/Calendar)
# ========================================
google.client.id=${GOOGLE_CLIENT_ID:}
google.client.secret=${GOOGLE_CLIENT_SECRET:}
google.redirect.uri=${GOOGLE_REDIRECT_URI:http://localhost:8080/api/v1/drive/callback}
app.frontend.url=${APP_FRONTEND_URL:http://localhost:3000}
meta.client.id=${META_CLIENT_ID:829099083620605}
meta.client.secret=${META_CLIENT_SECRET:e17cb64f7b6624482f3be4b3e4f8567c}
meta.redirect.uri=${META_REDIRECT_URI:https://server.somoswin.com.br/api/v1/marketing/auth/meta/callback}
meta.api.base-url=${META_API_URL:https://graph.facebook.com/v19.0}

# ========================================
# Server Configuration
# ========================================
server.port=8080
server.error.include-message=always
server.error.include-binding-errors=always

# ========================================
# Actuator (Health Checks for Docker)
# ========================================
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=always

# ========================================
# Multipart File Upload Configuration
# ========================================
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=1GB
spring.servlet.multipart.max-request-size=1GB

# ========================================
# Uazap WhatsApp API Configuration
# ========================================
uazap.default-base-url=${UAZAP_BASE_URL:https://servidorwin.uazapi.com}
uazap.default-token=${UAZAP_TOKEN:a04317a3-c594-45a5-b3fd-c9ae49fc0f95}
uazap.default-instance=${UAZAP_INSTANCE:ESSENCIALLIS}
uazap.admin-token=${UAZAP_ADMIN_TOKEN:2ugiNIUrXlX7qVZJ4Nkq2asMYdJEqCQjHCoT5IvwWHLpzU98Pb}

# ========================================
# Python Backend Configuration (Clinicorp)
# ========================================
python.backend.url=${PYTHON_BACKEND_URL:http://winai-python-backend:5000/api}

# ========================================
# Logging (Container optimized)
# ========================================
logging.level.root=INFO
logging.level.com.backend.winai=INFO
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
